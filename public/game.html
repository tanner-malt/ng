    <!-- Main Menu Popup (styled with .popup-modal and .popup-content from style.less) -->
    <div id="main-menu-popup" class="popup-modal" style="display:none;">
      <div class="popup-content">
        <h3>Main Menu</h3>
        <button id="resume-btn">Resume Game</button>
        <button id="settings-menu-btn">Settings</button>
        <button id="quit-menu-btn">Quit to Title</button>
        <button class="popup-close" onclick="document.getElementById('main-menu-popup').style.display='none'">Close</button>
      </div>
    </div>


    <!-- Notification overlay and container for tutorial/milestone notifications -->
    <div id="notification-overlay" style="display:none;"></div>
    <div id="notification-container" style="display:flex;"></div>
    <!-- Progression Popup -->
    <div id="progress-popup" class="popup-modal" style="display:none;">
      <div class="popup-content">
        <h3>Progression</h3>
        <div id="progress-battle"></div>
        <div id="progress-monarch"></div>
        <div id="progress-throne"></div>
        <button class="popup-close" onclick="document.getElementById('progress-popup').style.display='none'">Close</button>
      </div>
    </div>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Village Defense: Idleo</title>
    <link rel="stylesheet" href="game.css">
    <link rel="stylesheet" href="progress-icons.css">
</head>
<body>
    <div id="top-right-icons">
      <button id="sound-btn" class="icon-btn" title="Sound">
        <span>üîä</span>
      </button>
      <button id="settings-btn" class="icon-btn" title="Settings">
        <span>‚öôÔ∏è</span>
      </button>
      <button id="progress-btn" class="icon-btn progress-incomplete" title="Progression">
        <span id="progress-icon">üó∫Ô∏è</span>
      </button>
    </div>
    <div id="game-container">
        <nav id="view-navigation">
            <button class="nav-btn active" data-view="village" id="village-tab">Village</button>
            <button class="nav-btn" data-view="battle" id="battle-tab">Battle</button>
            <button class="nav-btn" data-view="monarch" id="monarch-tab">Monarch</button>
            <button class="nav-btn" data-view="throne" id="throne-tab">Throne</button>
        </nav>
        
        <main id="game-content">
            <!-- Village View -->
            <div id="village-view" class="game-view active">
                <div class="village-header">
                    <h2>Village Management</h2>
                    <div class="resource-panel">
                        <span>Food: <span id="food-count">100</span></span>
                        <span>Wood: <span id="wood-count">50</span></span>
                        <span>Stone: <span id="stone-count">25</span></span>
                        <span>Population: <span id="population-count">10</span></span>
                        <span>Season: <span id="season-display">Spring</span></span>
                    </div>
                </div>
                <div class="village-content">
                    <div id="village-grid" class="village-grid"></div>
                    <div class="village-sidebar">
                        <div class="building-menu">
                            <h3>Buildings</h3>
                            <button class="build-btn" data-building="house">House (10 Wood)</button>
                            <button class="build-btn" data-building="farm">Farm (15 Wood, 5 Stone)</button>
                            <button class="build-btn" data-building="townCenter">Town Center (50 Wood, 25 Stone)</button>
                            <button class="build-btn" data-building="barracks">Barracks (30 Wood, 20 Stone)</button>
                        </div>
                        <div class="village-info">
                            <h3>Village Stats</h3>
                            <p>Buildings: <span id="building-count">2</span></p>
                            <p>Supply Routes: <span id="supply-routes">Active</span></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Battle View -->
            <div id="battle-view" class="game-view">
                <div class="battle-header">
                    <h2>Automated Battle - Wave <span id="wave-count">1</span></h2>
                    <button id="start-battle-btn" class="action-btn">Start Battle</button>
                </div>
                <div class="battle-content">
                    <div id="battle-field">
                        <div class="battle-info">
                            <p>üõ°Ô∏è Watch your army automatically strategize and fight!</p>
                            <p>‚öîÔ∏è Battle outcomes depend on your village preparation</p>
                            <div id="battle-log"></div>
                        </div>
                    </div>
                    <div class="army-panel">
                        <h3>Your Army</h3>
                        <div id="army-units"></div>
                    </div>
                </div>
            </div>
            
            <!-- Monarch View -->
            <div id="monarch-view" class="game-view">
                <div class="monarch-header">
                    <h2>Royal Court</h2>
                    <div class="gold-display">Gold: <span id="gold-count">1000</span></div>
                </div>
                <div class="monarch-content">
                    <div class="investment-categories">
                        <div class="investment-category">
                            <h3>Village Improvements</h3>
                            <button class="investment-btn" data-cost="100">Production Boost (+10% efficiency) - 100 Gold</button>
                            <button class="investment-btn" data-cost="250">New Building Types - 250 Gold</button>
                            <button class="investment-btn" data-cost="500">Automation Level Up - 500 Gold</button>
                        </div>
                        <div class="investment-category">
                            <h3>Military Upgrades</h3>
                            <button class="investment-btn" data-cost="200">Army Scouts (Better AI) - 200 Gold</button>
                            <button class="investment-btn" data-cost="400">Elite Generals - 400 Gold</button>
                            <button class="investment-btn" data-cost="800">Tactical Academy - 800 Gold</button>
                        </div>
                        <div class="investment-category">
                            <h3>Legacy Systems</h3>
                            <button class="investment-btn" data-cost="1000">Parallel Villages - 1000 Gold</button>
                            <button class="investment-btn" data-cost="2000">Prestige Automation - 2000 Gold</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Throne View -->
            <div id="throne-view" class="game-view">
                <div class="throne-header">
                    <h2>Throne Room</h2>
                    <p>Merge ceremonial items for permanent bonuses</p>
                </div>
                <div class="throne-content">
                    <div id="merge-grid" class="merge-grid">
                        <!-- Merge items will be dynamically added here -->
                    </div>
                    <div class="merge-info">
                        <h3>Active Bonuses</h3>
                        <div id="active-bonuses">
                            <p>No bonuses yet - start merging!</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <div id="settings-popup" class="popup-modal" style="display:none;">
      <div class="popup-content">
        <h3>Menu</h3>
        <div id="game-version" style="margin-bottom:1rem; color:#bdc3c7; font-size:0.95rem;"></div>
        <button id="quit-btn">Quit to Title</button>
        <button class="popup-close" onclick="document.getElementById('settings-popup').style.display='none'">Close</button>
      </div>
    </div>
    
</main>
</div>

<div id="settings-popup" class="popup-modal" style="display:none;">
  <div class="popup-content">
    <h3>Menu</h3>
    <div id="game-version" style="margin-bottom:1rem; color:#bdc3c7; font-size:0.95rem;"></div>
    <button id="quit-btn">Quit to Title</button>
    <button class="popup-close" onclick="document.getElementById('settings-popup').style.display='none'">Close</button>
  </div>
</div>

<!-- Move all scripts to the very end of <body> so all DOM is loaded first -->
<script src="../src/gameState.js"></script>
<script src="../src/village.js"></script>
<script src="../src/battle.js"></script>
<script src="../src/monarch.js"></script>
<script src="../src/throne.js"></script>
<script src="../src/tutorial.js"></script>
<script src="../src/uiPopups.js"></script>
<script src="../src/app.js"></script>
</body>
</html>
</body>
</html>
