<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle: Dynasty Builder - DEBUG</title>
    <link rel="stylesheet" href="game.css">
    <link rel="stylesheet" href="progress-icons.css">
</head>
<body>
    <!-- Debug panel -->
    <div style="position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.9); color: white; padding: 10px; z-index: 10000; font-family: monospace; font-size: 12px; max-width: 400px; max-height: 300px; overflow-y: auto;" id="debug-panel">
        <strong>üêõ DEBUG PANEL</strong><br>
        <div id="debug-content">Loading...</div>
        <button onclick="updateDebug()" style="margin-top: 5px;">Refresh Debug</button>
    </div>

    <!-- Game Container (copied from game.html) -->
    <div id="game-container">
        <nav id="view-navigation">
            <button class="nav-btn active" data-view="village" id="village-tab">Village</button>
            <button class="nav-btn" data-view="battle" id="battle-tab">Battle</button>
            <button class="nav-btn" data-view="monarch" id="monarch-tab">Monarch (LOCKED)</button>
            <button class="nav-btn" data-view="throne" id="throne-tab">Throne</button>
        </nav>
        
        <main id="game-content">
            <!-- Village View -->
            <div id="village-view" class="game-view active">
                <div class="village-header">
                    <h2>Village Management</h2>
                    <div class="resource-panel">
                        <span>Food: <span id="food-count">100</span></span>
                        <span>Wood: <span id="wood-count">50</span></span>
                        <span>Stone: <span id="stone-count">25</span></span>
                        <span>Population: <span id="population-count">10</span></span>
                        <span>Season: <span id="season-count">Spring</span></span>
                    </div>
                </div>
                
                <div class="village-content">
                    <div id="village-grid" class="village-grid"></div>
                    
                    <div class="village-sidebar">
                        <div class="village-info">
                            <h3>Buildings</h3>
                            <div class="building-list">
                                <button class="building-btn" data-building="house">House</button>
                                <button class="building-btn" data-building="farm">Farm</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Load game scripts -->
    <script src="../src/gameState.js"></script>
    <script src="../src/modalSystem.js"></script>
    <script src="../src/village.js"></script>
    <script src="../src/battle.js"></script>
    <script src="../src/throne.js"></script>
    <script src="../src/monarch.js"></script>
    <script src="../src/quest.js"></script>
    <script src="../src/quests.js"></script>
    <script src="../src/tutorial.js"></script>
    <script src="../src/uiPopups.js"></script>
    <script src="../src/app.js"></script>
    
    <script>
        function updateDebug() {
            const debugContent = document.getElementById('debug-content');
            const villageGrid = document.getElementById('village-grid');
            const villageView = document.getElementById('village-view');
            const gameContainer = document.getElementById('game-container');
            
            const terrainTiles = villageGrid.querySelectorAll('.terrain-tile');
            const buildings = villageGrid.querySelectorAll('.building');
            
            const villageGridStyle = window.getComputedStyle(villageGrid);
            const villageViewStyle = window.getComputedStyle(villageView);
            
            debugContent.innerHTML = `
                <strong>Game State:</strong><br>
                - Game instance: ${window._gameInstance ? '‚úÖ' : '‚ùå'}<br>
                - window.game: ${window.game ? '‚úÖ' : '‚ùå'}<br>
                - Village manager via window.game: ${window.game?.villageManager ? '‚úÖ' : '‚ùå'}<br>
                - Village manager via _gameInstance: ${window._gameInstance?.villageManager ? '‚úÖ' : '‚ùå'}<br><br>
                
                <strong>DOM Elements:</strong><br>
                - Village view display: ${villageViewStyle.display}<br>
                - Village view classes: ${villageView.className}<br>
                - Village grid display: ${villageGridStyle.display}<br>
                - Village grid position: ${villageGridStyle.position}<br>
                - Village grid min-height: ${villageGridStyle.minHeight}<br><br>
                
                <strong>Content:</strong><br>
                - Terrain tiles: ${terrainTiles.length}<br>
                - Buildings: ${buildings.length}<br>
                - Grid innerHTML length: ${villageGrid.innerHTML.length}<br><br>
                
                <strong>Terrain Info:</strong><br>
                ${Array.from(terrainTiles).slice(0, 3).map(tile => 
                    `- ${tile.className}: ${tile.style.left}, ${tile.style.top}`
                ).join('<br>')}
                ${terrainTiles.length > 3 ? '<br>- ... and more' : ''}
            `;
        }
        
        // Initial debug update
        setTimeout(updateDebug, 100);
        
        // Update debug after game loads
        setTimeout(updateDebug, 2000);
        
        // Auto-update debug every 3 seconds
        setInterval(updateDebug, 3000);
    </script>
</body>
</html>
